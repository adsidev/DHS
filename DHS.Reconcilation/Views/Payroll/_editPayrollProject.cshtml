@model DHSEntities.PayrollResponse
@using DHS.Reconcilation.Models
@{
    ViewBag.Title = "Edit Payroll Project Information";
}
<div class="modal-dialog" role="document">
    <div class="modal-content">
        <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">Edit Payroll Project Information</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>
            <div class="modal-footer mra_edit_footer">
                <a href="Javascript:void()" title="Save" onclick="return SubmitValue()" id="btnSubmit" class="mra_edit_save">
                    <i class="fa fa-floppy-o" aria-hidden="true"></i>
                </a>
            </div>

            <div class="modal-body">
                <div class="mrp_modalcontent">
                    <div class="row">
                        <input type="hidden" value="@Model.payrollProjectEntity.PayrollProjectId" id="hdnPayrollProjectId" />

                        <div class="col-lg-12">
                            <div class="row">
                                <div class="col-lg-2 col-xs-12 col-sm-3 col-md-3">
                                    <div class="form_modal">
                                        <label>Payroll&nbsp;Number</label>
                                    </div>
                                </div>
                                <div class="col-lg-10 col-xs-12 col-sm-9 col-md-9">
                                    <div class="form_modal">
                                        <input type="text" value="@Model.payrollProjectEntity.PayrollNumber" id="PayrollNumber" class="form-control mrp_modalselect" disabled />
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="col-lg-12">
                            <div class="row">
                                <div class="col-lg-2 col-xs-12 col-sm-3 col-md-3">
                                    <div class="form_modal">
                                        <label>Fiscal Year</label>
                                    </div>
                                </div>
                                <div class="col-lg-10 col-xs-12 col-sm-9 col-md-9">
                                    <div class="form_modal">
                                        @Html.DropDownList("PFiscalYearId", new SelectList(Model.fiscalYearEntities, "FiscalYearId", "FiscalYear", Model.payrollProjectEntity.FiscalYearId), "", new { @id = "PFiscalYearId", @class = "form-control mrp_modalselect", @disabled="disabled" })
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="col-lg-12">
                            <div class="row">
                                <div class="col-lg-2 col-xs-12 col-sm-3 col-md-3">
                                    <div class="form_modal">
                                        <label>Project&nbsp;Name</label>
                                    </div>
                                </div>
                                <div class="col-lg-10 col-xs-12 col-sm-9 col-md-9">
                                    <div class="form_modal">
                                        @Html.DropDownList("ProjectId", new SelectList(Model.projectEntities, "ProjectId", "ProjectName", Model.payrollProjectEntity.ProjectId), "", new { @class = "form-control mrp_modalselect" })
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="col-lg-12">
                            <div class="row">
                                <div class="col-lg-2 col-xs-12 col-sm-3 col-md-3">
                                    <div class="form_modal">
                                        <label>Payroll&nbsp;Date</label>
                                    </div>
                                </div>
                                <div class="col-lg-10 col-xs-12 col-sm-9 col-md-9">
                                    <div class="form_modal">
                                        <input type="text" value="@Model.payrollProjectEntity.PayrollDate" id="PayrollDate" class="form-control mrp_modalselect" />
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="col-lg-12">
                            <div class="row">
                                <div class="col-lg-2 col-xs-12 col-sm-3 col-md-3">
                                    <div class="form_modal">
                                        <label>Effective&nbsp;Date</label>
                                    </div>
                                </div>
                                <div class="col-lg-10 col-xs-12 col-sm-9 col-md-9">
                                    <div class="form_modal">
                                        <input type="text" value="@Model.payrollProjectEntity.EffectiveDate" id="EffectiveDate" class="form-control mrp_modalselect" />
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="col-lg-12">
                            <div class="row">
                                <div class="col-lg-2 col-xs-12 col-sm-3 col-md-3">
                                    <div class="form_modal">
                                        <label>Payroll&nbsp;Total</label>
                                    </div>
                                </div>
                                <div class="col-lg-10 col-xs-12 col-sm-9 col-md-9">
                                    <div class="form_modal">
                                        @Html.TextBoxFor(m => m.payrollProjectEntity.PayrollTotal, htmlAttributes: new { @id = "PayrollTotal", Value = String.Format("{0:$#,##0.00}", Model.payrollProjectEntity.PayrollTotal), @class = "form-control mrp_modalselect" })
                                    </div>
                                </div>
                            </div>
                        </div>

                        @*<div class="col-lg-12">
                            <div class="row">
                                <div class="col-lg-2 col-xs-12 col-sm-3 col-md-3">
                                    <div class="form_modal">
                                        <label>Batch&nbsp;Number </label>
                                    </div>
                                </div>
                                <div class="col-lg-10 col-xs-12 col-sm-9 col-md-9">
                                    <div class="form_modal">
                                        @Html.TextBoxFor(m => m.payrollProjectEntity.BatchNumber, htmlAttributes: new { @id = "BatchNumber", @class = "form-control mrp_modalselect" })
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="col-lg-12">
                            <div class="row">
                                <div class="col-lg-2 col-xs-12 col-sm-3 col-md-3">
                                    <div class="form_modal">
                                        <label>Drawn&nbsp;Amount</label>
                                    </div>
                                </div>
                                <div class="col-lg-10 col-xs-12 col-sm-9 col-md-9">
                                    <div class="form_modal">
                                        @Html.TextBoxFor(m => m.payrollProjectEntity.DrawnAmount, htmlAttributes: new { @id = "DrawnAmount", Value = String.Format("{0:$#,##0.00}", Model.payrollProjectEntity.DrawnAmount), @class = "form-control mrp_modalselect" })
                                    </div>
                                </div>
                            </div>
                        </div>


                        <div class="col-lg-12">
                            <div class="row">
                                <div class="col-lg-2 col-xs-12 col-sm-3 col-md-3">
                                    <div class="form_modal">
                                        <label>Adjusted&nbsp;Amount</label>
                                    </div>
                                </div>
                                <div class="col-lg-10 col-xs-12 col-sm-9 col-md-9">
                                    <div class="form_modal">
                                        @Html.TextBoxFor(m => m.payrollProjectEntity.AdjustedAmount, htmlAttributes: new { @id = "AdjustedAmount", Value = String.Format("{0:$#,##0.00}", Model.payrollProjectEntity.AdjustedAmount), @class = "form-control mrp_modalselect" })
                                    </div>
                                </div>
                            </div>
                        </div>*@

                        <div class="col-lg-12">
                            <div class="row">
                                <div class="col-lg-2 col-xs-12 col-sm-3 col-md-3">
                                    <div class="form_modal">
                                        <label>Notes:</label>
                                    </div>
                                </div>
                                <div class="col-lg-10 col-xs-12 col-sm-9 col-md-9">
                                    <div class="form_modal">
                                        <textarea id="Notes" name="Notes" style="margin: 0px; width: 100%; height: 80px;">@Model.payrollProjectEntity.Notes</textarea>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script type="text/javascript">
    function SubmitValue() {
        
        if (document.getElementById("ProjectId").value == "") {
            alert("Please select project.")
            document.getElementById("ProjectId").focus();
            return false;
        }

        if (document.getElementById("PayrollDate").value == "") {
            alert("Please enter payroll date.");
            document.getElementById("PayrollDate").focus();
            return false;
        }

        if (document.getElementById("EffectiveDate").value == "") {
            alert("Please enter effective date.");
            document.getElementById("EffectiveDate").focus();
            return false;
        }

        if (document.getElementById("PayrollTotal").value == "$0.00" || document.getElementById("PayrollTotal").value == "") {
            alert("Please enter payroll total.");
            document.getElementById("PayrollTotal").focus();
            return false;
        }

            var payrollProjectEntity = {
                PayrollProjectId: document.getElementById("hdnPayrollProjectId").value,
                ProjectId: document.getElementById("ProjectId").value,
                PayrollDate: document.getElementById("PayrollDate").value,
                FiscalYearId: document.getElementById("PFiscalYearId").value,
                EffectiveDate: document.getElementById("EffectiveDate").value,
                PayrollTotal: parseFloat((document.getElementById("PayrollTotal").value).replace("$", "").replace(",", "")).toFixed(2),
                Notes: document.getElementById("Notes").value,
                ModifiedBy:@Common.GetSession("UserID"),
            };

            var payrollRequest = {
                payrollProjectEntity: payrollProjectEntity
            };
            $.ajax({
                url: "/Payroll/SavePayrollProject",
                type: "POST",
                data: payrollRequest,
                dataType: 'json',
                success: function (result) {
                    window.location.reload();
                },
                complete: function () {

                }
            });
            return true;
        }
</script>
