@model DHSEntities.ProjectResponse
@using DHS.Reconcilation.Models

@{
    ViewBag.Title = "DHS Reconcilation Application :: Project Details";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<title>@ViewBag.Title</title>
<script src="~/Scripts/jquery-1.10.2.min.js"></script>
@section LeftMenuSection
{
    @Html.Partial("_menuCRPayments");
}

<title>@ViewBag.Title</title>


<script src="~/js/jquery.min.js"></script>
<script type="text/javascript">
    function ValidateFields() {
        var FiscalYear = $('#FiscalYearId option:selected').text();

        if (FiscalYear == "") {
            alert("Please select Fiscal Year.");
            $("#FiscalYear").focus();
            return false;
        }

        return true;
    }
    $(document).ready(function () {
        $('#mra_subliPRS').addClass('active');
    });
</script>
@using (Html.BeginForm("ManageProjectSummary", "Project", FormMethod.Post, new { @id = "frmManageProjectSummary" }))
{
    <div class="tab-pane active" id="dashboard">
        <div class="container-fluid mra_settlement_view">
            <!-- top tiles -->
            <div class="row ">
                <div class="col-lg-10">
                    <div class="mrp_content">
                        <h2>View Project Detail Information</h2>
                        <form class="mrp_selectdetails form-inline"></form>
                    </div>
                </div>
            </div>

            <div class="row mrp_table-row">
                <div class="col-lg-12 col-xs-12">
                    <div class="table-responsive">
                        <div class="mrp_contentbody mrp_contenttable">
                            <div class="mrp_table">
                                <table class="table table-bordered table-striped">
                                    <thead>
                                        <tr>
                                            <th nowrap>
                                                Project Name
                                            </th>
                                            <th nowrap>
                                                Expense Amount
                                            </th>
                                            <th nowrap>
                                                Reconciled Expense Amount
                                            </th>
                                            <th nowrap>
                                                Difference
                                            </th>
                                            <th nowrap>
                                                Revenue Amount
                                            </th>
                                            <th nowrap>
                                                Reconciled Revenue Amount
                                            </th>
                                            <th nowrap>
                                                Difference
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td nowrap>
                                                    @Model.projectEntity.ProjectName.ToUpper()
                                            </td>
                                            <td>
                                                @string.Format("{0:C}", Model.projectEntity.ExpenseAmount)
                                            </td>
                                            <td>
                                                @string.Format("{0:C}", Model.projectEntity.ExpenseTransactionAmount)
                                            </td>
                                            <td>
                                                @string.Format("{0:C}", (Model.projectEntity.ExpenseAmount - Model.projectEntity.ExpenseTransactionAmount))
                                            </td>
                                            <td>
                                                @string.Format("{0:C}", Model.projectEntity.RevenueAmount)
                                            </td>
                                            <td>
                                                @string.Format("{0:C}", Model.projectEntity.RevenueTransactionAmount)
                                            </td>
                                            <td>
                                                @string.Format("{0:C}", (Model.projectEntity.RevenueAmount - Model.projectEntity.RevenueTransactionAmount))
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>

                            </div>
                        </div>
                    </div>
                    <!-- /top tiles -->
                </div>
            </div>

            <div class="row ">
                <div class="col-lg-12">
                    <div class="mrp_content">
                        <h2>Project Expenses</h2>
                        <form class="mrp_selectdetails form-inline"></form>
                    </div>
                </div>
            </div>

            <div class="row mrp_table-row">
                <div class="col-lg-12 col-xs-12">
                    <div class="table-responsive">
                        <div class="mrp_contentbody mrp_contenttable">
                            <div class="mrp_table">
                                <table class="table table-bordered table-striped">
                                    <thead>
                                        <tr>
                                            <th nowrap>
                                                Status
                                            </th>
                                            <th nowrap>
                                                Exp No
                                            </th>
                                            <th nowrap>
                                                Net Amount
                                            </th>
                                            <th nowrap>
                                                Period
                                            </th>
                                            <th nowrap>
                                                Fiscal Year
                                            </th>
                                            <th nowrap>
                                                Journal
                                            </th>
                                            <th nowrap>
                                                Source
                                            </th>
                                            <th nowrap>
                                                Fund
                                            </th>
                                            <th nowrap>
                                                Org
                                            </th>
                                            <th nowrap>
                                                Function
                                            </th>
                                            <th nowrap>
                                                Function Description
                                            </th>
                                            <th nowrap>
                                                Department
                                            </th>
                                            <th nowrap>
                                                Department Description
                                            </th>
                                            <th nowrap>
                                                Activity
                                            </th>
                                            <th nowrap>
                                                Activity Description
                                            </th>
                                            <th nowrap>
                                                Object
                                            </th>
                                            <th nowrap>
                                                Object Description
                                            </th>
                                            <th nowrap>
                                                Project
                                            </th>
                                            <th nowrap>
                                                Project Title
                                            </th>
                                            <th nowrap>
                                                CFDA
                                            </th>
                                            <th nowrap>
                                                Reference 1
                                            </th>
                                            <th nowrap>
                                                Reference 2
                                            </th>
                                            <th nowrap>
                                                Reference 3
                                            </th>
                                            <th nowrap>
                                                Reference 4
                                            </th>
                                            <th nowrap>
                                                Assigned To
                                            </th>
                                            <th nowrap style="text-align:left">
                                                Notes
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        @{decimal ExpenseTotal = 0;
                                            foreach (var item in Model.expenseEntities)
                                            {
                                                ExpenseTotal = ExpenseTotal + item.NetAmount;
                                                <tr>
                                                    <td nowrap>
                                                        @item.StatusName
                                                    </td>
                                                    <td nowrap>
                                                        @item.ExpenseNumber
                                                    </td>
                                                    <td nowrap>
                                                        @string.Format("{0:C}", item.NetAmount)
                                                    </td>
                                                    <td nowrap>
                                                        @item.PeriodName
                                                    </td>
                                                    <td nowrap>
                                                        @item.FiscalYear
                                                    </td>
                                                    <td nowrap>
                                                        @item.Journal
                                                    </td>
                                                    <td nowrap>
                                                        @item.SourceName
                                                    </td>
                                                    <td>
                                                        @item.Fund
                                                    </td>
                                                    <td>
                                                        @item.OrgName
                                                    </td>
                                                    <td nowrap>
                                                        @item.FunctionName
                                                    </td>
                                                    <td nowrap>
                                                        @item.FunctionDescription
                                                    </td>
                                                    <td nowrap>
                                                        @item.DepartmentName
                                                    </td>
                                                    <td nowrap>
                                                        @item.DepartmentDescription
                                                    </td>
                                                    <td nowrap>
                                                        @item.ActivityName
                                                    </td>
                                                    <td nowrap>
                                                        @item.ActivityDescription
                                                    </td>
                                                    <td nowrap>
                                                        @item.ObjectName
                                                    </td>
                                                    <td nowrap>
                                                        @item.ObjectDescription
                                                    </td>
                                                    <td nowrap>
                                                        @item.ProjectName
                                                    </td>
                                                    <td nowrap>
                                                        @item.ProjectDescription
                                                    </td>
                                                    <td nowrap>
                                                        @item.CFDA
                                                    </td>
                                                    <td nowrap>
                                                        @item.Reference1
                                                    </td>
                                                    <td nowrap>
                                                        @item.Reference2
                                                    </td>
                                                    <td nowrap>
                                                        @item.Reference3
                                                    </td>
                                                    <td nowrap>
                                                        @item.Reference4
                                                    </td>
                                                    <td nowrap>
                                                        @item.AssignedToUser
                                                    </td>
                                                    <td nowrap style="text-align:left">
                                                        @item.Notes
                                                    </td>
                                                </tr>
                                            }
                                            if (Model.expenseEntities.Count > 0)
                                            {
                                                <tr>
                                                    <td colspan="2" style="text-align:right"><b>Total: </b></td>
                                                    <td colspan="30" style="text-align:left;"><b>@String.Format("{0:$#,##0.00}", ExpenseTotal)</b></td>
                                                </tr>
                                            }
                                        }
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    <!-- /top tiles -->
                </div>
            </div>


            <div class="row ">
                <div class="col-lg-12">
                    <div class="mrp_content">
                        <h2> Reconciled Expense Amount</h2>
                        <form class="mrp_selectdetails form-inline"></form>
                    </div>
                </div>
            </div>

            <div class="row mrp_table-row">
                <div class="col-lg-12 col-xs-12">
                    <div class="table-responsive">
                        <div class="mrp_contentbody mrp_contenttable">
                            <div class="mrp_table">
                                <table class="table table-bordered table-striped">
                                    <thead>
                                        <tr>
                                            <th nowrap>
                                                Transaction No
                                            </th>
                                            <th nowrap>
                                                Transaction Date
                                            </th>
                                            <th nowrap>
                                                Transaction Amount
                                            </th>
                                            <th nowrap>
                                                Org
                                            </th>
                                            <th nowrap>
                                                Object
                                            </th>
                                            <th nowrap>
                                                Project
                                            </th>
                                            <th nowrap>
                                                CFDA
                                            </th>
                                            <th nowrap>
                                                Category 1
                                            </th>
                                            <th nowrap>
                                                Category 2
                                            </th>
                                            <th nowrap>
                                                Status
                                            </th>
                                            <th nowrap>
                                                Vendor Name
                                            </th>
                                            <th nowrap>
                                                Revenue Transaction
                                            </th>
                                            <th nowrap style="text-align:left">
                                                Notes
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        @{
                                            decimal Total = 0;
                                            string RevenueInfo = string.Empty;
                                            foreach (var item in Model.transactionDetailEntities)
                                            {
                                                Total = Total + item.TransactionAmount;
                                                RevenueInfo = item.RevenueTransactionNumber + " - " + item.RevenueTransactionDate + " - " + String.Format("{0:$#,##0.00}", item.RevenueTransactionAmount) + " - " + item.RevenueProjectName + " - " + item.BatchNumber + " - " + String.Format("{0:$#,##0.00}", item.DrawAmount) + " - " + item.DrawDate;
                                                <tr>
                                                    <td nowrap>
                                                        @item.TransactionNumber
                                                    </td>
                                                    <td nowrap>
                                                        @item.TransactionDate
                                                    </td>
                                                    <td nowrap>
                                                        @String.Format("{0:$#,##0.00}", item.TransactionAmount)
                                                    </td>
                                                    <td nowrap>
                                                        @item.OrgName
                                                    </td>
                                                    <td nowrap>
                                                        @item.ObjectName
                                                    </td>
                                                    <td nowrap>
                                                        @item.ProjectName
                                                    </td>
                                                    <td nowrap>
                                                        @item.CFDA
                                                    </td>
                                                    <td nowrap>
                                                        @item.FGTCategoryName1
                                                    </td>
                                                    <td nowrap>
                                                        @item.FGTCategoryName2
                                                    </td>
                                                    <td nowrap>
                                                        @item.StatusName
                                                    </td>
                                                    <td nowrap>
                                                        @item.VendorName
                                                    </td>
                                                    @if (item.RevenueTransactionNumber != "")
                                                    {
                                                        <td nowrap>@RevenueInfo</td>
                                                    }
                                                    else
                                                    {
                                                        <td nowrap>&nbsp;</td>
                                                    }
                                                    <td style="text-align:left;" nowrap>
                                                        @item.TransactionDescription
                                                    </td>
                                                </tr>
                                            }
                                            if (Model.transactionDetailEntities.Count > 0)
                                            {
                                                <tr>
                                                    <td colspan="2" style="text-align:right"><b>Total: </b></td>
                                                    <td colspan="2" style="text-align:left;"><b>@String.Format("{0:$#,##0.00}", Total)</b></td>
                                                    <td colspan="2" style="text-align:right"><b>Difference: </b></td>
                                                    <td colspan="7" style="text-align:left"><b>@String.Format("{0:$#,##0.00}", (ExpenseTotal - Total))</b></td>
                                                </tr>
                                            }
                                        }
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    <!-- /top tiles -->
                </div>
            </div>



            <div class="row ">
                <div class="col-lg-12">
                    <div class="mrp_content">
                        <h2>Project Revenues</h2>
                        <form class="mrp_selectdetails form-inline"></form>
                    </div>
                </div>
            </div>

            <div class="row mrp_table-row">
                <div class="col-lg-12 col-xs-12">
                    <div class="table-responsive">
                        <div class="mrp_contentbody mrp_contenttable">
                            <div class="mrp_table">
                                <table class="table table-bordered table-striped">
                                    <thead>
                                        <tr>
                                            <th nowrap>Draw No</th>
                                            <th nowrap>
                                                Rev No
                                            </th>
                                            <th nowrap>
                                                Period
                                            </th>
                                            <th nowrap>
                                                Net Amount
                                            </th>
                                            <th nowrap>
                                                Revenue Amount
                                            </th>
                                            <th nowrap>
                                                Fiscal Year
                                            </th>
                                            @*<th nowrap>
                                            Revenue Date
                                        </th>*@
                                            <th nowrap>
                                                Journal
                                            </th>
                                            <th nowrap>
                                                Source
                                            </th>
                                            <th nowrap>
                                                Fund
                                            </th>
                                            <th nowrap>
                                                Org
                                            </th>
                                            <th nowrap>
                                                Function
                                            </th>
                                            <th nowrap>
                                                Function Description
                                            </th>
                                            <th nowrap>
                                                Department
                                            </th>
                                            <th nowrap>
                                                Department Description
                                            </th>
                                            <th nowrap>
                                                Activity
                                            </th>
                                            <th nowrap>
                                                Activity Description
                                            </th>
                                            <th nowrap>
                                                Object
                                            </th>
                                            <th nowrap>
                                                Object Description
                                            </th>
                                            <th nowrap>
                                                Project
                                            </th>
                                            <th nowrap>
                                                Project Title
                                            </th>
                                            <th nowrap>
                                                CFDA
                                            </th>
                                            <th nowrap>
                                                Reference 1
                                            </th>
                                            <th nowrap>
                                                Reference 2
                                            </th>
                                            <th nowrap>
                                                Reference 3
                                            </th>
                                            <th nowrap>
                                                Reference 4
                                            </th>
                                            <th nowrap>
                                                Status
                                            </th>
                                            <th nowrap>
                                                Revenue Type
                                            </th>
                                            <th nowrap style="text-align:left;">
                                                Notes
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        @{decimal revenueTotal = 0;
                                            foreach (var item in Model.revenueEntities)
                                            {
                                                revenueTotal = revenueTotal + item.RevenueAmount;
                                                <tr>
                                                    <td>
                                                        @item.DrawNumber
                                                    </td>
                                                    <td nowrap>
                                                        <a class="img-responsive" onclick="ViewRevenue('@item.RevenueId')" style="cursor:pointer;"> @item.RevenueNumber</a>
                                                    </td>
                                                    <td nowrap>
                                                        @item.PeriodName
                                                    </td>
                                                    <td nowrap style="text-align:right">
                                                        @string.Format("{0:C}", item.NetAmount)
                                                    </td>
                                                    <td nowrap style="text-align:right">
                                                        @string.Format("{0:C}", item.RevenueAmount)
                                                    </td>
                                                    <td nowrap>
                                                        @item.FiscalYear
                                                    </td>
                                                    @*<td nowrap>
                                                    @item.RevenueDate
                                                </td>*@
                                                    <td nowrap>
                                                        @item.Journal
                                                    </td>
                                                    <td nowrap>
                                                        @item.SourceName
                                                    </td>
                                                    <td>
                                                        @item.Fund
                                                    </td>
                                                    <td>
                                                        @item.OrgName
                                                    </td>
                                                    <td nowrap>
                                                        @item.FunctionName
                                                    </td>
                                                    <td nowrap>
                                                        @item.FunctionDescription
                                                    </td>
                                                    <td nowrap>
                                                        @item.DepartmentName
                                                    </td>
                                                    <td nowrap>
                                                        @item.DepartmentDescription
                                                    </td>
                                                    <td nowrap>
                                                        @item.ActivityName
                                                    </td>
                                                    <td nowrap>
                                                        @item.ActivityDescription
                                                    </td>
                                                    <td nowrap>
                                                        @item.ObjectName
                                                    </td>
                                                    <td nowrap>
                                                        @item.ObjectDescription
                                                    </td>
                                                    <td nowrap>
                                                        @item.ProjectName
                                                    </td>
                                                    <td nowrap>
                                                        @item.ProjectDescription
                                                    </td>
                                                    <td nowrap>
                                                        @item.CFDA
                                                    </td>
                                                    <td nowrap>
                                                        @item.Reference1
                                                    </td>
                                                    <td nowrap>
                                                        @item.Reference2
                                                    </td>
                                                    <td nowrap>
                                                        @item.Reference3
                                                    </td>
                                                    <td nowrap>
                                                        @item.Reference4
                                                    </td>
                                                    <td nowrap>
                                                        @item.StatusName
                                                    </td>
                                                    <td nowrap>
                                                        @item.RevenueTypeName
                                                    </td>
                                                    <td nowrap style="text-align:left;">
                                                        @item.Notes
                                                    </td>
                                                </tr>
                                            }
                                            if (Model.revenueEntities.Count > 0)
                                            {
                                                <tr>
                                                    <td colspan="4" style="text-align:right"><b>Total: </b></td>
                                                    <td colspan="27" style="text-align:left;"><b>@String.Format("{0:$#,##0.00}", revenueTotal)</b></td>
                                                </tr>
                                            }
                                        }
                                    </tbody>
                                </table>

                                <!-- popup -->
                                <div class="modal fade mrp_modalpopup" id="RevenueModal">
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- /top tiles -->
                </div>
            </div>

            <div class="row ">
                <div class="col-lg-12">
                    <div class="mrp_content">
                        <h2>Reconciled Revenue Amount</h2>
                    </div>
                </div>
            </div>

            <div class="row mrp_table-row">
                <div class="col-lg-12 col-xs-12">
                    <div class="table-responsive">
                        <div class="mrp_contentbody mrp_contenttable">
                            <div class="mrp_table">
                                <table class="table table-bordered table-striped">
                                    <thead>
                                        <tr>
                                            <th nowrap>
                                                Transaction No
                                            </th>
                                            <th nowrap>
                                                Revenue Trans Date
                                            </th>
                                            <th nowrap>
                                                Revenue Trans Amount
                                            </th>
                                            <th nowrap>
                                                Org
                                            </th>
                                            <th nowrap>
                                                Object
                                            </th>
                                            <th nowrap>
                                                Project
                                            </th>
                                            <th nowrap>
                                                Revenue Type
                                            </th>
                                            <th nowrap>
                                                Draw
                                            </th>
                                            <th nowrap>
                                                Batch Number
                                            </th>
                                            <th nowrap style="text-align:left;">
                                                Notes
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        @{
                                            decimal RevenueTotal = 0;
                                            foreach (var item in Model.revenueTransactionEntities)
                                            {
                                                RevenueTotal = RevenueTotal + item.RevenueTransactionAmount;
                                                <tr>
                                                    <td>
                                                        @item.RevenueTransactionNumber
                                                    </td>
                                                    <td>
                                                        @item.RevenueTransactionDate
                                                    </td>
                                                    <td>
                                                        @String.Format("{0:$#,##0.00}", item.RevenueTransactionAmount)
                                                    </td>
                                                    <td>
                                                        @item.OrgName
                                                    </td>
                                                    <td>
                                                        @item.ObjectName
                                                    </td>
                                                    <td>
                                                        @item.ProjectName
                                                    </td>
                                                    <td>
                                                        @item.RevenueTypeName
                                                    </td>
                                                    <td>
                                                        @item.DrawNumber
                                                    </td>
                                                    <td>
                                                        @item.BatchNumber
                                                    </td>
                                                    <td nowrap style="text-align:left;">
                                                        @item.RevenueTranscationDescription
                                                    </td>
                                                </tr>
                                            }
                                            if (Model.revenueTransactionEntities.Count > 0)
                                            {
                                                <tr>
                                                    <td colspan="2" style="text-align:right"><b>Total: </b></td>
                                                    <td colspan="2" style="text-align:left"><b>@String.Format("{0:$#,##0.00}", RevenueTotal)</b></td>
                                                    <td colspan="2" style="text-align:right"><b>Difference: </b></td>
                                                    <td colspan="7" style="text-align:left"><b>@String.Format("{0:$#,##0.00}", (revenueTotal - RevenueTotal))</b></td>
                                                </tr>
                                            }
                                        }
                                    </tbody>
                                </table>

                                <!-- popup -->
                                <div class="modal fade mrp_modalpopup" id="RevenueTransactionModal">
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- /top tiles -->
                </div>
            </div>
        </div>
    </div>
}
